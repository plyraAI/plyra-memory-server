# API Reference

All HTTP routes exposed by plyra-memory-server.

## Base URL

```
http://your-server:7700
```

## Authentication

All memory routes (`/v1/*`) require a Bearer token:

```
Authorization: Bearer plm_live_abc123...
```

Admin routes (`/admin/*`) require the `PLYRA_ADMIN_API_KEY` value.

## API key format

```
plm_live_<48 random hex chars>    production keys
plm_test_<48 random hex chars>    test / dev keys
```

Keys are generated by `POST /admin/keys`. The plaintext value is shown
once at creation time — never stored in the server database.

## Namespacing

Every request is namespaced to: `workspace_id / user_id / agent_id`.

- `workspace_id` — derived from the API key (server-side, not client-provided)
- `user_id` — optional, passed in request body
- `agent_id` — optional, passed in request body

Omitting `user_id` and `agent_id` stores memory at the workspace level.

## Routes

| Method | Route | Auth | Description |
|--------|-------|------|-------------|
| GET | `/` | none | Service info |
| GET | `/health` | none | Health check |
| POST | [`/v1/remember`](remember.md) | key | Write to memory |
| POST | [`/v1/recall`](recall.md) | key | Search memory |
| POST | [`/v1/context`](context.md) | key | Get prompt context |
| GET | [`/v1/stats`](stats.md) | key | Memory counts |
| DELETE | `/v1/memory` | key | Clear working memory |
| POST | [`/admin/keys`](admin.md) | admin | Create API key |
| GET | [`/admin/keys/{workspace}`](admin.md) | admin | List keys |
| DELETE | [`/admin/keys/{key_id}`](admin.md) | admin | Revoke key |

## Response headers

Every response includes:

```
X-Latency-Ms: 12.4
```

## Health check

```bash
curl http://localhost:7700/health
```

```json
{
  "status": "ok",
  "version": "0.1.0",
  "uptime_seconds": 3600.1,
  "env": "production",
  "store": "/data/memory.db",
  "vectors": "/data/memory.index"
}
```

---

**Routes:**
[/v1/remember →](remember.md) ·
[/v1/recall →](recall.md) ·
[/v1/context →](context.md) ·
[/v1/stats →](stats.md) ·
[/admin/keys →](admin.md)
