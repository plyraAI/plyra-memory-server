{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Home","text":"plyra-memory-server <p>Self-hosted memory infrastructure for agentic AI.   Multi-tenant. API key auth. Workspace isolation.</p> Three commands <p>Clone, configure, docker compose up. Server running on :7700.</p> API key auth <p>plm_live_... keys. SHA-256 hashed. Create and revoke via admin API.</p> Workspace isolation <p>workspace \u2192 user \u2192 agent. No cross-tenant memory access.</p> Zero client changes <p>Set two env vars. plyra-memory routes to server automatically.</p>"},{"location":"#what-this-is","title":"What this is","text":"<p>plyra-memory-server is the server component of the plyra-memory stack.</p> <pre><code>Agent A (LangGraph)   \u2500\u2510\nAgent B (AutoGen)     \u2500\u2500\u2524\u2500\u2500 plyra-memory-server \u2500\u2500 persistent storage\nAgent C (plain Python) \u2500\u2518         \u2191\n                             plm_live_abc123\n                           Authorization: Bearer\n</code></pre> <p>The library (plyra-memory) handles local mode. The server handles multi-agent, multi-tenant production.</p>"},{"location":"#when-to-use-this","title":"When to use this","text":"<p>Use plyra-memory-server when:</p> <ul> <li>More than one agent process needs to share memory</li> <li>Memory must survive container restarts and deployments</li> <li>You need per-workspace isolation between different teams or customers</li> <li>You want a single memory endpoint across multiple machines</li> </ul> <p>For single-agent development, use plyra-memory locally \u2014 zero setup.</p>"},{"location":"#start-here","title":"Start here","text":"Quickstart <p>Server running in 3 commands.</p> Azure <p>Production deploy on Azure Container Apps.</p> API reference <p>All routes, request/response schemas.</p> Isolation model <p>How workspace \u2192 user \u2192 agent works.</p> <p>Part of the Plyra open-source stack. Also see plyra-memory (library) and plyra-guard (action middleware).</p>"},{"location":"changelog/","title":"Changelog","text":""},{"location":"changelog/#v010","title":"v0.1.0","text":"<ul> <li>FastAPI server on port 7700</li> <li>API key authentication (SHA-256 hashed, SQLite key store)</li> <li>Workspace \u2192 user \u2192 agent isolation</li> <li>Routes: <code>/v1/remember</code>, <code>/v1/recall</code>, <code>/v1/context</code>, <code>/v1/stats</code></li> <li>Admin routes: <code>/admin/keys</code> (create, list, revoke)</li> <li>Docker image with pre-baked sentence-transformers model</li> <li><code>docker-compose.yml</code> (SQLite) and <code>docker-compose.postgres.yml</code></li> <li>HTTP backend in plyra-memory library (auto-detect via env vars)</li> <li>21 tests passing on Python 3.11, 3.12, 3.13</li> </ul> <p>GitHub releases</p>"},{"location":"configuration/","title":"Configuration","text":"<p>All configuration via environment variables. Set in <code>.env</code> or pass directly to Docker.</p>"},{"location":"configuration/#full-reference","title":"Full reference","text":"Variable Default Required Description <code>PLYRA_ADMIN_API_KEY</code> <code>plm_admin_changeme</code> yes Admin key for <code>/admin/keys</code> routes. Change before production. <code>PLYRA_HOST</code> <code>0.0.0.0</code> no Bind address <code>PLYRA_PORT</code> <code>7700</code> no HTTP port <code>PLYRA_ENV</code> <code>local</code> no Environment tag (<code>local</code>, <code>staging</code>, <code>production</code>) <code>PLYRA_DEBUG</code> <code>false</code> no Enable debug logging <code>PLYRA_STORE_URL</code> <code>~/.plyra/memory.db</code> no SQLite path for memory storage <code>PLYRA_VECTORS_URL</code> <code>~/.plyra/memory.index</code> no ChromaDB path for vector index <code>PLYRA_KEY_STORE_URL</code> <code>~/.plyra/keys.db</code> no SQLite path for API key storage <code>PLYRA_RATE_LIMIT_RPM</code> <code>600</code> no Requests per minute per API key <code>PLYRA_CORS_ORIGINS</code> <code>[\"*\"]</code> no Allowed CORS origins <code>ANTHROPIC_API_KEY</code> \u2014 no Enables server-side LLM fact extraction via Anthropic <code>OPENAI_API_KEY</code> \u2014 no Enables server-side LLM fact extraction via OpenAI"},{"location":"configuration/#minimal-production-env","title":"Minimal production .env","text":"<pre><code># Required\nPLYRA_ADMIN_API_KEY=plm_admin_&lt;strong_random_value&gt;\n\n# Storage paths (Docker volume mounted at /data)\nPLYRA_STORE_URL=/data/memory.db\nPLYRA_VECTORS_URL=/data/memory.index\nPLYRA_KEY_STORE_URL=/data/keys.db\n\n# Environment tag\nPLYRA_ENV=production\n\n# Optional: LLM for server-side fact extraction\nANTHROPIC_API_KEY=sk-ant-...\n</code></pre>"},{"location":"configuration/#docker-environment","title":"Docker environment","text":"<p>Pass env vars to Docker Compose via <code>.env</code> file (auto-loaded) or inline:</p> <pre><code>PLYRA_ADMIN_API_KEY=strong_key \\\nANTHROPIC_API_KEY=sk-ant-... \\\ndocker compose up -d\n</code></pre>"},{"location":"configuration/#azure-environment","title":"Azure environment","text":"<p>Set via Container Apps secrets and env vars:</p> <pre><code># Create secret\naz containerapp secret set \\\n  --name plyra-memory-server \\\n  --resource-group plyra-rg \\\n  --secrets admin-key=\"plm_admin_strong_key\"\n\n# Reference in env vars\naz containerapp update \\\n  --name plyra-memory-server \\\n  --resource-group plyra-rg \\\n  --set-env-vars \\\n    PLYRA_ADMIN_API_KEY=secretref:admin-key \\\n    PLYRA_ENV=production\n</code></pre> <p>\u2192 Full Azure guide</p>"},{"location":"configuration/#llm-extraction","title":"LLM extraction","text":"<p>Set <code>ANTHROPIC_API_KEY</code> or <code>OPENAI_API_KEY</code> to enable server-side fact extraction. When set, all <code>remember()</code> calls use LLM extraction regardless of client configuration.</p> <p>\u2192 LLM extraction guide</p> <p>\u2190 Quickstart \u00b7 API reference \u2192</p>"},{"location":"quickstart/","title":"Quickstart","text":"<p>Server running and accepting memory in 3 commands.</p>"},{"location":"quickstart/#prerequisites","title":"Prerequisites","text":"<ul> <li>Docker + Docker Compose</li> <li>plyra-memory installed in your agent</li> </ul>"},{"location":"quickstart/#1-clone-and-configure","title":"1. Clone and configure","text":"<pre><code>git clone https://github.com/plyraAI/plyra-memory-server\ncd plyra-memory-server\ncp .env.example .env\n</code></pre> <p>Open <code>.env</code> and set a strong admin key:</p> <pre><code>PLYRA_ADMIN_API_KEY=plm_admin_your_strong_key_here\n</code></pre> <p>Change the admin key</p> <p>The default <code>plm_admin_changeme</code> is insecure. Set a strong random value before exposing the server to any network.</p>"},{"location":"quickstart/#2-start-the-server","title":"2. Start the server","text":"<pre><code>docker compose up -d\n</code></pre> <p>Verify it's running:</p> <pre><code>curl http://localhost:7700/health\n# {\"status\":\"ok\",\"version\":\"0.1.0\",\"uptime_seconds\":1.2,...}\n</code></pre>"},{"location":"quickstart/#3-create-your-first-api-key","title":"3. Create your first API key","text":"<pre><code>curl -X POST http://localhost:7700/admin/keys \\\n  -H \"Authorization: Bearer your-admin-key\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"workspace_id\": \"my-workspace\",\n    \"label\": \"dev\",\n    \"env\": \"live\"\n  }'\n</code></pre> <p>Response:</p> <pre><code>{\n  \"key\": \"plm_live_a1b2c3d4e5f6g7h8i9j0...\",\n  \"key_id\": \"abc123\",\n  \"workspace_id\": \"my-workspace\",\n  \"env\": \"live\"\n}\n</code></pre> <p>Save this key</p> <p>The plaintext key is shown exactly once and never stored. Copy it now.</p>"},{"location":"quickstart/#4-connect-your-agent","title":"4. Connect your agent","text":"<p>Set two environment variables in your agent's environment:</p> <pre><code>export PLYRA_SERVER_URL=http://localhost:7700\nexport PLYRA_API_KEY=plm_live_a1b2c3d4e5f6...\n</code></pre> <p>Your agent code is unchanged:</p> <pre><code>from plyra_memory import Memory\n\nasync with Memory(agent_id=\"my-agent\") as memory:\n    await memory.remember(\"user prefers Python async frameworks\")\n    ctx = await memory.context_for(\"what stack does the user use?\")\n    print(ctx.content)\n</code></pre> <p>plyra-memory detects <code>PLYRA_SERVER_URL</code> and routes all operations to the server automatically. Local storage is not used.</p>"},{"location":"quickstart/#verify-end-to-end","title":"Verify end-to-end","text":"<pre><code># Write memory via curl\ncurl -X POST http://localhost:7700/v1/remember \\\n  -H \"Authorization: Bearer plm_live_...\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"content\": \"user prefers TypeScript\", \"agent_id\": \"test-agent\"}'\n\n# Read context via curl\ncurl -X POST http://localhost:7700/v1/context \\\n  -H \"Authorization: Bearer plm_live_...\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"query\": \"what does the user prefer?\", \"agent_id\": \"test-agent\"}'\n</code></pre>"},{"location":"quickstart/#next-steps","title":"Next steps","text":"<ul> <li>Configuration \u2192 \u2014 all env vars</li> <li>API reference \u2192 \u2014 full route documentation</li> <li>Azure deployment \u2192 \u2014 production hosting</li> </ul> <p>Next: Configuration \u2192</p>"},{"location":"api/","title":"API Reference","text":"<p>All HTTP routes exposed by plyra-memory-server.</p>"},{"location":"api/#base-url","title":"Base URL","text":"<pre><code>http://your-server:7700\n</code></pre>"},{"location":"api/#authentication","title":"Authentication","text":"<p>All memory routes (<code>/v1/*</code>) require a Bearer token:</p> <pre><code>Authorization: Bearer plm_live_abc123...\n</code></pre> <p>Admin routes (<code>/admin/*</code>) require the <code>PLYRA_ADMIN_API_KEY</code> value.</p>"},{"location":"api/#api-key-format","title":"API key format","text":"<pre><code>plm_live_&lt;48 random hex chars&gt;    production keys\nplm_test_&lt;48 random hex chars&gt;    test / dev keys\n</code></pre> <p>Keys are generated by <code>POST /admin/keys</code>. The plaintext value is shown once at creation time \u2014 never stored in the server database.</p>"},{"location":"api/#namespacing","title":"Namespacing","text":"<p>Every request is namespaced to: <code>workspace_id / user_id / agent_id</code>.</p> <ul> <li><code>workspace_id</code> \u2014 derived from the API key (server-side, not client-provided)</li> <li><code>user_id</code> \u2014 optional, passed in request body</li> <li><code>agent_id</code> \u2014 optional, passed in request body</li> </ul> <p>Omitting <code>user_id</code> and <code>agent_id</code> stores memory at the workspace level.</p>"},{"location":"api/#routes","title":"Routes","text":"Method Route Auth Description GET <code>/</code> none Service info GET <code>/health</code> none Health check POST <code>/v1/remember</code> key Write to memory POST <code>/v1/recall</code> key Search memory POST <code>/v1/context</code> key Get prompt context GET <code>/v1/stats</code> key Memory counts DELETE <code>/v1/memory</code> key Clear working memory POST <code>/admin/keys</code> admin Create API key GET <code>/admin/keys/{workspace}</code> admin List keys DELETE <code>/admin/keys/{key_id}</code> admin Revoke key"},{"location":"api/#response-headers","title":"Response headers","text":"<p>Every response includes:</p> <pre><code>X-Latency-Ms: 12.4\n</code></pre>"},{"location":"api/#health-check","title":"Health check","text":"<pre><code>curl http://localhost:7700/health\n</code></pre> <pre><code>{\n  \"status\": \"ok\",\n  \"version\": \"0.1.0\",\n  \"uptime_seconds\": 3600.1,\n  \"env\": \"production\",\n  \"store\": \"/data/memory.db\",\n  \"vectors\": \"/data/memory.index\"\n}\n</code></pre> <p>Routes: /v1/remember \u2192 \u00b7 /v1/recall \u2192 \u00b7 /v1/context \u2192 \u00b7 /v1/stats \u2192 \u00b7 /admin/keys \u2192</p>"},{"location":"api/admin/","title":"Admin \u2014 API Keys","text":"<p>Create, list, and revoke API keys. Requires <code>PLYRA_ADMIN_API_KEY</code>.</p>"},{"location":"api/admin/#post-adminkeys-create-key","title":"POST /admin/keys \u2014 Create key","text":"<pre><code>curl -X POST http://localhost:7700/admin/keys \\\n  -H \"Authorization: Bearer plm_admin_...\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"workspace_id\":   \"acme-corp\",\n    \"label\":          \"production agent\",\n    \"env\":            \"live\",\n    \"rate_limit_rpm\": 600\n  }'\n</code></pre>"},{"location":"api/admin/#request-fields","title":"Request fields","text":"Field Type Required Description <code>workspace_id</code> string yes Workspace this key belongs to <code>label</code> string no Human-readable label <code>env</code> string no <code>live</code> or <code>test</code> (default: <code>live</code>) <code>rate_limit_rpm</code> int no Override default rate limit"},{"location":"api/admin/#response","title":"Response","text":"<pre><code>{\n  \"key\":          \"plm_live_a1b2c3...\",\n  \"key_id\":       \"abc123def456\",\n  \"workspace_id\": \"acme-corp\",\n  \"label\":        \"production agent\",\n  \"env\":          \"live\",\n  \"created_at\":   \"2025-11-01T09:00:00Z\",\n  \"is_active\":    true\n}\n</code></pre> <p>Warning</p> <p><code>key</code> is the plaintext value \u2014 shown once, never stored. Copy it immediately.</p>"},{"location":"api/admin/#get-adminkeysworkspace_id-list-keys","title":"GET /admin/keys/{workspace_id} \u2014 List keys","text":"<pre><code>curl http://localhost:7700/admin/keys/acme-corp \\\n  -H \"Authorization: Bearer plm_admin_...\"\n</code></pre> <p>Returns list of <code>APIKeyInfo</code> objects. Plaintext key values are never included \u2014 only the first 16 characters as <code>key_prefix</code>.</p> <pre><code>[\n  {\n    \"key_id\":       \"abc123\",\n    \"workspace_id\": \"acme-corp\",\n    \"key_prefix\":   \"plm_live_a1b2c3...\",\n    \"label\":        \"production agent\",\n    \"env\":          \"live\",\n    \"created_at\":   \"2025-11-01T09:00:00Z\",\n    \"last_used_at\": \"2025-11-15T14:23:00Z\",\n    \"is_active\":    true\n  }\n]\n</code></pre>"},{"location":"api/admin/#delete-adminkeyskey_id-revoke-key","title":"DELETE /admin/keys/{key_id} \u2014 Revoke key","text":"<pre><code>curl -X DELETE http://localhost:7700/admin/keys/abc123 \\\n  -H \"Authorization: Bearer plm_admin_...\"\n</code></pre> <pre><code>{\"revoked\": true, \"key_id\": \"abc123\"}\n</code></pre> <p>Revoked keys return <code>401</code> immediately on next use. Revocation is instant \u2014 no propagation delay.</p> <p>\u2192 Key management guide</p> <p>\u2190 /v1/stats \u00b7 Deployment \u2192</p>"},{"location":"api/context/","title":"POST /v1/context","text":"<p>Get a prompt-ready context string. Call this before every LLM invocation.</p>"},{"location":"api/context/#request","title":"Request","text":"<pre><code>POST /v1/context\nAuthorization: Bearer plm_live_...\nContent-Type: application/json\n</code></pre> <pre><code>{\n  \"query\":        \"what is the user working on?\",\n  \"user_id\":      \"user_xyz\",\n  \"agent_id\":     \"support-agent\",\n  \"token_budget\": 2048\n}\n</code></pre>"},{"location":"api/context/#fields","title":"Fields","text":"Field Type Required Default Description <code>query</code> string yes \u2014 What to retrieve. Usually the user's message. <code>user_id</code> string no null Namespace filter <code>agent_id</code> string no null Namespace filter <code>token_budget</code> int no <code>2048</code> Max tokens in returned context. Range: 64\u201332,000."},{"location":"api/context/#response","title":"Response","text":"<pre><code>{\n  \"query\":         \"what is the user working on?\",\n  \"content\":       \"[WORKING MEMORY]\\nuser asked about deployment...\\n\\n[SEMANTIC]\\nuser WORKS_ON LangGraph agent\",\n  \"token_count\":   142,\n  \"token_budget\":  2048,\n  \"memories_used\": 4,\n  \"cache_hit\":     false,\n  \"latency_ms\":    11.7\n}\n</code></pre> <p>Inject <code>content</code> into your LLM system prompt:</p> <pre><code>ctx = await client.post(\"/v1/context\", json={\"query\": user_message}).json()\n\nprompt = f\"\"\"You are a helpful assistant.\n\n{ctx['content']}\n\nUser: {user_message}\"\"\"\n</code></pre>"},{"location":"api/context/#example","title":"Example","text":"<pre><code>curl -X POST http://localhost:7700/v1/context \\\n  -H \"Authorization: Bearer plm_live_...\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"query\": \"what is the user building?\", \"token_budget\": 1024}'\n</code></pre> <p>\u2190 /v1/recall \u00b7 /v1/stats \u2192</p>"},{"location":"api/recall/","title":"POST /v1/recall","text":"<p>Search memory by semantic similarity. Returns ranked results from all layers.</p>"},{"location":"api/recall/#request","title":"Request","text":"<pre><code>POST /v1/recall\nAuthorization: Bearer plm_live_...\nContent-Type: application/json\n</code></pre> <pre><code>{\n  \"query\":    \"what does the user prefer?\",\n  \"user_id\":  \"user_xyz\",\n  \"agent_id\": \"support-agent\",\n  \"top_k\":    10,\n  \"layers\":   [\"working\", \"episodic\", \"semantic\"]\n}\n</code></pre>"},{"location":"api/recall/#fields","title":"Fields","text":"Field Type Required Default Description <code>query</code> string yes \u2014 Semantic search query <code>user_id</code> string no null Filter to this user namespace <code>agent_id</code> string no null Filter to this agent namespace <code>top_k</code> int no <code>10</code> Max results. Range: 1\u2013100. <code>layers</code> array no all Layers to search: <code>working</code>, <code>episodic</code>, <code>semantic</code>"},{"location":"api/recall/#response","title":"Response","text":"<pre><code>{\n  \"query\":       \"what does the user prefer?\",\n  \"results\":     [...],\n  \"total_found\": 5,\n  \"cache_hit\":   false,\n  \"latency_ms\":  14.2\n}\n</code></pre> <p>Each result in <code>results</code> is a ranked memory entry with <code>score</code>, <code>content</code>, <code>layer</code>, <code>created_at</code>, and any stored metadata.</p>"},{"location":"api/recall/#example","title":"Example","text":"<pre><code>curl -X POST http://localhost:7700/v1/recall \\\n  -H \"Authorization: Bearer plm_live_...\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"query\": \"what does the user prefer?\", \"top_k\": 5}'\n</code></pre> <p>\u2190 /v1/remember \u00b7 /v1/context \u2192</p>"},{"location":"api/remember/","title":"POST /v1/remember","text":"<p>Write content to all memory layers for a workspace/user/agent.</p>"},{"location":"api/remember/#request","title":"Request","text":"<pre><code>POST /v1/remember\nAuthorization: Bearer plm_live_...\nContent-Type: application/json\n</code></pre> <pre><code>{\n  \"content\":    \"user prefers Python async frameworks\",\n  \"user_id\":    \"user_xyz\",\n  \"agent_id\":   \"support-agent\",\n  \"importance\": 0.8,\n  \"source\":     \"user_message\",\n  \"metadata\":   {}\n}\n</code></pre>"},{"location":"api/remember/#fields","title":"Fields","text":"Field Type Required Default Description <code>content</code> string yes \u2014 Content to store. Max 32,000 chars. <code>user_id</code> string no null User namespace within workspace. <code>agent_id</code> string no null Agent namespace within user. <code>importance</code> float no <code>0.6</code> Priority 0.0\u20131.0. Affects working memory eviction. <code>source</code> string no null Content origin. Maps to EpisodeEvent. <code>metadata</code> object no <code>{}</code> Arbitrary key-value metadata."},{"location":"api/remember/#source-values","title":"Source values","text":"Value Maps to <code>user_message</code> <code>USER_MESSAGE</code> <code>agent_response</code> <code>AGENT_RESPONSE</code> <code>tool_output</code> <code>TOOL_RESULT</code> <code>tool_call</code> <code>TOOL_CALL</code> null <code>AGENT_RESPONSE</code>"},{"location":"api/remember/#response","title":"Response","text":"<pre><code>{\n  \"working_entry_id\": \"a1b2c3d4...\",\n  \"episode_id\":       \"e5f6g7h8...\",\n  \"facts_queued\":     true,\n  \"latency_ms\":       8.3\n}\n</code></pre> <p><code>facts_queued: true</code> means fact extraction is running as a background task. Facts appear in semantic memory within ~500ms.</p>"},{"location":"api/remember/#example","title":"Example","text":"<pre><code>curl -X POST http://localhost:7700/v1/remember \\\n  -H \"Authorization: Bearer plm_live_...\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"content\": \"my name is Alex, I prefer TypeScript\",\n    \"agent_id\": \"support-agent\",\n    \"source\": \"user_message\",\n    \"importance\": 0.9\n  }'\n</code></pre> <p>\u2190 API overview \u00b7 /v1/recall \u2192</p>"},{"location":"api/stats/","title":"GET /v1/stats","text":"<p>Get summary statistics for memory usage across layers.</p>"},{"location":"api/stats/#request","title":"Request","text":"<pre><code>GET /v1/stats\nAuthorization: Bearer plm_live_...\n</code></pre> <p>To filter by user or agent, pass query parameters:</p> <pre><code>GET /v1/stats?user_id=user_xyz&amp;agent_id=support-agent\n</code></pre>"},{"location":"api/stats/#response","title":"Response","text":"<pre><code>{\n  \"total_memories\": 125,\n  \"by_layer\": {\n    \"working\": 15,\n    \"episodic\": 80,\n    \"semantic\": 30\n  },\n  \"namespace\": {\n    \"workspace_id\": \"acme-corp\",\n    \"user_id\":      \"user_xyz\",\n    \"agent_id\":     \"support-agent\"\n  }\n}\n</code></pre> <p>\u2190 /v1/context \u00b7 Admin keys \u2192</p>"},{"location":"deploy/","title":"Deployment","text":"<p>plyra-memory-server ships as a Docker image. Three deployment paths:</p> Path Use case Complexity Docker Compose Local, single server, dev Low Azure Container Apps Production, scalable, managed Medium Manual Custom environments, no Docker Low"},{"location":"deploy/#which-to-choose","title":"Which to choose","text":"<p>Docker Compose \u2014 start here. Works on any machine with Docker. SQLite for storage, zero external dependencies. Upgrade to Postgres when you need multi-instance.</p> <p>Azure Container Apps \u2014 production deployment. Managed HTTPS, persistent volume, scales to zero when idle, ~$5\u201315/month at low traffic.</p> <p>Manual \u2014 for environments where Docker isn't available. <code>pip install plyra-memory-server</code> then <code>plyra-server</code>.</p> <p>Docker \u2192 \u00b7 Azure \u2192 \u00b7 Manual \u2192</p>"},{"location":"deploy/azure/","title":"Azure Container Apps","text":"<p>Production deployment on Azure. Managed HTTPS, persistent storage, scales to zero when idle.</p>"},{"location":"deploy/azure/#prerequisites","title":"Prerequisites","text":"<pre><code># Install Azure CLI\ncurl -sL https://aka.ms/InstallAzureCLIDeb | sudo bash\naz login\naz extension add --name containerapp --upgrade\n</code></pre>"},{"location":"deploy/azure/#step-1-resource-group-and-environment","title":"Step 1 \u2014 Resource group and environment","text":"<pre><code>az group create \\\n  --name plyra-rg \\\n  --location eastus\n\naz containerapp env create \\\n  --name plyra-env \\\n  --resource-group plyra-rg \\\n  --location eastus\n</code></pre>"},{"location":"deploy/azure/#step-2-persistent-storage","title":"Step 2 \u2014 Persistent storage","text":"<pre><code># Storage account for SQLite persistence\naz storage account create \\\n  --name plyrastorage$RANDOM \\\n  --resource-group plyra-rg \\\n  --sku Standard_LRS \\\n  --location eastus\n\n# File share (mounted at /data in container)\nSTORAGE_ACCOUNT=$(az storage account list \\\n  --resource-group plyra-rg \\\n  --query \"[0].name\" -o tsv)\n\naz storage share create \\\n  --name plyra-data \\\n  --account-name $STORAGE_ACCOUNT\n\nSTORAGE_KEY=$(az storage account keys list \\\n  --resource-group plyra-rg \\\n  --account-name $STORAGE_ACCOUNT \\\n  --query \"[0].value\" -o tsv)\n</code></pre>"},{"location":"deploy/azure/#step-3-admin-key-secret","title":"Step 3 \u2014 Admin key secret","text":"<pre><code>az containerapp env secret set \\\n  --name plyra-env \\\n  --resource-group plyra-rg \\\n  --secrets admin-key=\"plm_admin_your_strong_key_here\"\n</code></pre>"},{"location":"deploy/azure/#step-4-deploy","title":"Step 4 \u2014 Deploy","text":"<pre><code>az containerapp create \\\n  --name plyra-memory-server \\\n  --resource-group plyra-rg \\\n  --environment plyra-env \\\n  --image ghcr.io/plyraai/plyra-memory-server:latest \\\n  --target-port 7700 \\\n  --ingress external \\\n  --min-replicas 0 \\\n  --max-replicas 3 \\\n  --cpu 0.5 \\\n  --memory 1.0Gi \\\n  --env-vars \\\n    PLYRA_ADMIN_API_KEY=secretref:admin-key \\\n    PLYRA_STORE_URL=/data/memory.db \\\n    PLYRA_VECTORS_URL=/data/memory.index \\\n    PLYRA_KEY_STORE_URL=/data/keys.db \\\n    PLYRA_ENV=production\n</code></pre>"},{"location":"deploy/azure/#step-5-get-your-url","title":"Step 5 \u2014 Get your URL","text":"<pre><code>az containerapp show \\\n  --name plyra-memory-server \\\n  --resource-group plyra-rg \\\n  --query properties.configuration.ingress.fqdn \\\n  --output tsv\n# \u2192 plyra-memory-server.eastus.azurecontainerapps.io\n</code></pre>"},{"location":"deploy/azure/#step-6-verify","title":"Step 6 \u2014 Verify","text":"<pre><code>SERVER=https://plyra-memory-server.eastus.azurecontainerapps.io\n\ncurl $SERVER/health\n# {\"status\":\"ok\",...}\n\ncurl -X POST $SERVER/admin/keys \\\n  -H \"Authorization: Bearer plm_admin_your_strong_key_here\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"workspace_id\":\"test\",\"env\":\"live\"}'\n</code></pre>"},{"location":"deploy/azure/#step-7-connect-your-agent","title":"Step 7 \u2014 Connect your agent","text":"<pre><code>export PLYRA_SERVER_URL=https://plyra-memory-server.eastus.azurecontainerapps.io\nexport PLYRA_API_KEY=plm_live_...\n</code></pre> <pre><code>from plyra_memory import Memory\n\nasync with Memory(agent_id=\"my-agent\") as memory:\n    await memory.remember(\"deployed to Azure\")\n</code></pre>"},{"location":"deploy/azure/#scaling","title":"Scaling","text":"<pre><code># Adjust min/max replicas\naz containerapp update \\\n  --name plyra-memory-server \\\n  --resource-group plyra-rg \\\n  --min-replicas 1 \\   # keep warm, no cold start\n  --max-replicas 10\n</code></pre> <p>SQLite and multiple replicas</p> <p>SQLite supports only one writer at a time. If you scale beyond one replica, migrate to Postgres first. \u2192 Postgres migration</p>"},{"location":"deploy/azure/#cost-estimate","title":"Cost estimate","text":"Component Free tier Paid Container Apps 180,000 vCPU-s/month free ~$0.000024/vCPU-s Storage account 5GB free $0.02/GB File share included \u2014 <p>At low traffic (scales to zero): ~$0\u20135/month.</p> <p>\u2190 Docker \u00b7 Manual \u2192</p>"},{"location":"deploy/docker/","title":"Docker Deployment","text":""},{"location":"deploy/docker/#sqlite-default-zero-dependencies","title":"SQLite (default \u2014 zero dependencies)","text":"<pre><code>git clone https://github.com/plyraAI/plyra-memory-server\ncd plyra-memory-server\ncp .env.example .env\n# Edit .env \u2014 set PLYRA_ADMIN_API_KEY\n\ndocker compose up -d\n</code></pre> <p>Data persists in a named Docker volume (<code>plyra_data</code>).</p> <pre><code># Check status\ndocker compose ps\ndocker compose logs memory-server --tail 20\n\n# Stop\ndocker compose down\n\n# Stop and delete data\ndocker compose down -v\n</code></pre>"},{"location":"deploy/docker/#postgres-multi-instance","title":"Postgres (multi-instance)","text":"<pre><code># Set a strong Postgres password\necho \"POSTGRES_PASSWORD=strong_password\" &gt;&gt; .env\n\ndocker compose -f docker-compose.postgres.yml up -d\n</code></pre> <p>Postgres data persists in <code>postgres_data</code> volume. Memory server connects automatically on startup.</p>"},{"location":"deploy/docker/#update-to-new-version","title":"Update to new version","text":"<pre><code>docker compose pull\ndocker compose up -d\n</code></pre>"},{"location":"deploy/docker/#persistent-volume-location","title":"Persistent volume location","text":"<pre><code># Find volume mount on host\ndocker volume inspect plyra_data\n</code></pre> <p>Default: <code>/var/lib/docker/volumes/plyra_data/_data/</code></p> <p>\u2192 Postgres migration guide</p> <p>\u2190 Deploy overview \u00b7 Azure \u2192</p>"},{"location":"deploy/manual/","title":"Manual Deployment","text":"<p>If you cannot use Docker or Azure, you can run the server directly on any machine with Python 3.11+.</p>"},{"location":"deploy/manual/#prerequisites","title":"Prerequisites","text":"<ul> <li>Python 3.11, 3.12, or 3.13</li> <li>A supervisor like <code>systemd</code> or <code>pm2</code></li> </ul>"},{"location":"deploy/manual/#1-install","title":"1. Install","text":"<pre><code># Create a virtual environment\npython -m venv .venv\nsource .venv/bin/activate\n\n# Install the server\npip install plyra-memory-server\n</code></pre>"},{"location":"deploy/manual/#2-configure","title":"2. Configure","text":"<p>Set environment variables in your environment or via a <code>.env</code> file in the working directory.</p> <pre><code>export PLYRA_ADMIN_API_KEY=plm_admin_your_strong_key_here\nexport PLYRA_STORE_URL=/path/to/persistent/memory.db\nexport PLYRA_VECTORS_URL=/path/to/persistent/memory.index\nexport PLYRA_KEY_STORE_URL=/path/to/persistent/keys.db\nexport PLYRA_ENV=production\n</code></pre>"},{"location":"deploy/manual/#3-run","title":"3. Run","text":"<p>The server includes a built-in CLI powered by Uvicorn.</p> <pre><code>plyra-server\n</code></pre> <p>To bind to all interfaces on port 80:</p> <pre><code>PLYRA_HOST=0.0.0.0 PLYRA_PORT=80 plyra-server\n</code></pre>"},{"location":"deploy/manual/#4-systemd-service-linux","title":"4. systemd service (Linux)","text":"<p>Create <code>/etc/systemd/system/plyra-server.service</code>:</p> <pre><code>[Unit]\nDescription=plyra-memory-server\nAfter=network.target\n\n[Service]\nUser=plyra\nGroup=plyra\nWorkingDirectory=/opt/plyra\nEnvironmentFile=/opt/plyra/.env\nExecStart=/opt/plyra/.venv/bin/plyra-server\nRestart=always\n\n[Install]\nWantedBy=multi-user.target\n</code></pre> <pre><code>sudo systemctl enable plyra-server\nsudo systemctl start plyra-server\n</code></pre> <p>\u2190 Azure</p>"},{"location":"guides/api-keys/","title":"API Key Management","text":"<p>Key lifecycle, rotation, and security best practices.</p>"},{"location":"guides/api-keys/#key-format","title":"Key format","text":"<pre><code>plm_live_&lt;48 hex chars&gt;    production\nplm_test_&lt;48 hex chars&gt;    development / testing\n</code></pre> <p><code>plm</code> = plyra memory. <code>live</code> vs <code>test</code> is informational \u2014 the server does not enforce different behaviour based on env, but it helps you track which keys belong to which environment.</p>"},{"location":"guides/api-keys/#creating-keys","title":"Creating keys","text":"<pre><code>curl -X POST http://localhost:7700/admin/keys \\\n  -H \"Authorization: Bearer $PLYRA_ADMIN_KEY\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"workspace_id\": \"acme-corp\",\n    \"label\": \"production \u2014 support agent\",\n    \"env\": \"live\"\n  }'\n</code></pre> <p>Create one key per: - Agent (tightest isolation) - Environment (dev key, staging key, production key) - Team or workspace (customer-level isolation)</p>"},{"location":"guides/api-keys/#revoking-keys","title":"Revoking keys","text":"<pre><code># List keys for a workspace to get key_id\ncurl http://localhost:7700/admin/keys/acme-corp \\\n  -H \"Authorization: Bearer $PLYRA_ADMIN_KEY\"\n\n# Revoke by key_id\ncurl -X DELETE http://localhost:7700/admin/keys/{key_id} \\\n  -H \"Authorization: Bearer $PLYRA_ADMIN_KEY\"\n</code></pre> <p>Revocation is instant. The revoked key returns <code>401</code> on next use.</p>"},{"location":"guides/api-keys/#key-rotation","title":"Key rotation","text":"<p>Rotate production keys periodically or after any suspected compromise:</p> <pre><code># 1. Create new key\nNEW_KEY=$(curl -X POST http://localhost:7700/admin/keys \\\n  -H \"Authorization: Bearer $PLYRA_ADMIN_KEY\" \\\n  -d '{\"workspace_id\":\"acme\",\"label\":\"rotated key\"}' | jq -r .key)\n\n# 2. Update env var in your agent deployment\n# 3. Redeploy agents with new key\n# 4. Verify agents are using new key\n# 5. Revoke old key\ncurl -X DELETE http://localhost:7700/admin/keys/{old_key_id} \\\n  -H \"Authorization: Bearer $PLYRA_ADMIN_KEY\"\n</code></pre>"},{"location":"guides/api-keys/#security-checklist","title":"Security checklist","text":"<ul> <li>Never commit API keys to git</li> <li>Use environment variables or secrets managers (Azure Key Vault, etc.)</li> <li>Set <code>PLYRA_ADMIN_API_KEY</code> to a strong random value before deployment</li> <li>Use separate keys for dev, staging, production</li> <li>Revoke unused keys</li> </ul> <p>\u2190 Workspace isolation \u00b7 Postgres migration \u2192</p>"},{"location":"guides/isolation/","title":"Workspace Isolation","text":"<p>How plyra-memory-server separates memory between tenants.</p>"},{"location":"guides/isolation/#the-hierarchy","title":"The hierarchy","text":"<pre><code>workspace_id          \u2190 derived from API key (server-enforced)\n  \u2514\u2500\u2500 user_id         \u2190 passed by client (optional)\n        \u2514\u2500\u2500 agent_id  \u2190 passed by client (optional)\n</code></pre> <p>Every API key belongs to exactly one workspace. <code>workspace_id</code> is never passed by the client \u2014 the server derives it from the API key. A client cannot access another workspace's memory even if it knows the <code>workspace_id</code>.</p>"},{"location":"guides/isolation/#storage-namespacing","title":"Storage namespacing","text":"<p>Internally, memory is stored under a compound key:</p> <pre><code>ws_{workspace_id}:u_{user_id}:a_{agent_id}\n</code></pre> <p>For example: - <code>ws_acme:u_user123:a_support-agent</code> - <code>ws_acme:u_user456:a_support-agent</code>   \u2190 same agent, different user - <code>ws_acme</code>                             \u2190 workspace-level (no user/agent)</p> <p>These are completely separate memory namespaces. No cross-contamination.</p>"},{"location":"guides/isolation/#workspace-isolation-guarantee","title":"Workspace isolation guarantee","text":"<p>Two clients with different API keys cannot access each other's memory, even if they use the same <code>user_id</code> and <code>agent_id</code> values:</p> <pre><code># Key A (workspace \"acme\")\nawait memory_a.remember(\"acme secret data\")\n\n# Key B (workspace \"other\")\nctx = await memory_b.context_for(\"acme secret\")\n# \u2192 empty. Server enforces isolation.\n</code></pre> <p>This is verified by the <code>test_workspace_isolation</code> test in the test suite.</p>"},{"location":"guides/isolation/#multi-agent-within-a-workspace","title":"Multi-agent within a workspace","text":"<p>Multiple agents in the same workspace can share memory by omitting <code>agent_id</code> or by using a shared namespace:</p> <pre><code># Agent A and Agent B both read/write workspace-level memory\nawait memory.remember(content, metadata={\"user_id\": \"user_xyz\"})\n# No agent_id \u2192 stored at workspace/user level, visible to all agents\n</code></pre> <p>Or give each agent its own namespace: <pre><code># Agent-specific memory (not shared)\nawait memory.remember(content,\n    metadata={\"user_id\": \"user_xyz\", \"agent_id\": \"agent-a\"})\n</code></pre></p> <p>\u2192 Multi-agent guide</p> <p>\u2190 Admin keys \u00b7 API key management \u2192</p>"},{"location":"guides/llm-extraction/","title":"Server-Side LLM Extraction","text":"<p>Configure the server to use LLM-powered fact extraction for all agents.</p>"},{"location":"guides/llm-extraction/#how-it-works","title":"How it works","text":"<p>When <code>ANTHROPIC_API_KEY</code> or <code>OPENAI_API_KEY</code> is set on the server, all <code>remember()</code> calls use <code>LLMExtractor</code> instead of the default regex. This applies to every agent connecting to this server.</p>"},{"location":"guides/llm-extraction/#configure","title":"Configure","text":"<pre><code># .env\nANTHROPIC_API_KEY=sk-ant-...\n</code></pre> <p>Or for OpenAI: <pre><code>OPENAI_API_KEY=sk-...\n</code></pre></p> <p>Restart the server after changing: <pre><code>docker compose up -d --force-recreate\n</code></pre></p>"},{"location":"guides/llm-extraction/#verify-extraction-is-running","title":"Verify extraction is running","text":"<pre><code># Write a message with implicit preferences\ncurl -X POST http://localhost:7700/v1/remember \\\n  -H \"Authorization: Bearer plm_live_...\" \\\n  -d '{\"content\": \"I mostly reach for TypeScript these days\"}'\n\n# Wait ~1 second for background extraction, then recall\ncurl -X POST http://localhost:7700/v1/context \\\n  -H \"Authorization: Bearer plm_live_...\" \\\n  -d '{\"query\": \"what language does the user prefer?\"}'\n# \u2192 context should mention TypeScript\n</code></pre>"},{"location":"guides/llm-extraction/#client-vs-server-extraction","title":"Client vs server extraction","text":"Client-side Server-side Config <code>Memory.with_anthropic(api_key=...)</code> <code>ANTHROPIC_API_KEY</code> on server Applies to that agent only all agents on this server API key in agent environment in server environment only <p>Server-side is simpler for multi-agent setups \u2014 one API key to manage.</p> <p>\u2192 LLM extraction docs</p> <p>\u2190 Postgres migration \u00b7 Production checklist \u2192</p>"},{"location":"guides/postgres/","title":"Postgres Migration","text":"<p>Migrate from SQLite to Postgres for multi-instance deployments.</p>"},{"location":"guides/postgres/#when-to-migrate","title":"When to migrate","text":"<p>Migrate when you need: - More than one server replica (SQLite allows one writer) - Managed database backups and point-in-time recovery - Larger memory datasets (SQLite practical limit ~1GB)</p>"},{"location":"guides/postgres/#setup","title":"Setup","text":"<pre><code># docker-compose.postgres.yml is included in the repo\nPOSTGRES_PASSWORD=strong_password \\\n  docker compose -f docker-compose.postgres.yml up -d\n</code></pre> <p>The server connects to Postgres automatically when <code>PLYRA_DATABASE_URL</code> is set:</p> <pre><code>PLYRA_DATABASE_URL=postgresql://plyra:password@postgres:5432/plyra_memory\n</code></pre>"},{"location":"guides/postgres/#migrate-existing-data","title":"Migrate existing data","text":"<p>Automated migration script (coming in v0.2.0):</p> <pre><code># Export from SQLite\nplyra-server export --format json &gt; memory_export.json\n\n# Import to Postgres\nPLYRA_DATABASE_URL=postgres://... \\\n  plyra-server import --file memory_export.json\n</code></pre> <p>For v0.1.0: start fresh with Postgres. SQLite data cannot be migrated automatically yet.</p>"},{"location":"guides/postgres/#azure-postgres","title":"Azure Postgres","text":"<pre><code>az postgres flexible-server create \\\n  --resource-group plyra-rg \\\n  --name plyra-db \\\n  --sku-name Standard_B1ms \\\n  --tier Burstable \\\n  --admin-user plyra \\\n  --admin-password $POSTGRES_PASSWORD \\\n  --database-name plyra_memory\n</code></pre> <p>\u2190 API key management \u00b7 LLM extraction \u2192</p>"},{"location":"guides/production/","title":"Production Checklist","text":"<p>Before going to production with plyra-memory-server.</p>"},{"location":"guides/production/#security","title":"Security","text":"<ul> <li>[ ] <code>PLYRA_ADMIN_API_KEY</code> changed from default</li> <li>[ ] Admin key stored in secrets manager (Azure Key Vault, etc.)</li> <li>[ ] HTTPS enforced (Azure Container Apps handles this automatically)</li> <li>[ ] CORS origins restricted if server is public-facing</li> <li>[ ] No API keys committed to git</li> </ul>"},{"location":"guides/production/#storage","title":"Storage","text":"<ul> <li>[ ] Persistent volume mounted at <code>/data</code></li> <li>[ ] Volume backed up regularly (Azure File Share snapshots)</li> <li>[ ] If running multiple replicas: Postgres configured</li> </ul>"},{"location":"guides/production/#monitoring","title":"Monitoring","text":"<ul> <li>[ ] <code>/health</code> endpoint monitored (Azure health probe configured)</li> <li>[ ] Container logs routed to Log Analytics or similar</li> <li>[ ] Alert on 5xx error rate</li> </ul>"},{"location":"guides/production/#performance","title":"Performance","text":"<ul> <li>[ ] <code>PLYRA_RATE_LIMIT_RPM</code> tuned for expected load</li> <li>[ ] Min replicas set to 1 if cold start latency is unacceptable</li> <li>[ ] <code>ANTHROPIC_API_KEY</code> set if LLM extraction is needed</li> </ul>"},{"location":"guides/production/#verification","title":"Verification","text":"<pre><code># Health check\ncurl https://your-server/health\n\n# Create a test key\ncurl -X POST https://your-server/admin/keys \\\n  -H \"Authorization: Bearer $ADMIN_KEY\" \\\n  -d '{\"workspace_id\":\"smoke-test\",\"env\":\"test\"}'\n\n# Write and read\ncurl -X POST https://your-server/v1/remember \\\n  -H \"Authorization: Bearer $TEST_KEY\" \\\n  -d '{\"content\":\"production smoke test\"}'\n\ncurl -X POST https://your-server/v1/context \\\n  -H \"Authorization: Bearer $TEST_KEY\" \\\n  -d '{\"query\":\"smoke test\",\"token_budget\":128}'\n\n# Revoke test key\ncurl -X DELETE https://your-server/admin/keys/{key_id} \\\n  -H \"Authorization: Bearer $ADMIN_KEY\"\n</code></pre> <p>\u2190 LLM extraction \u00b7 Home \u2192</p>"}]}